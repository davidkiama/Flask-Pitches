{% macro displayPitches(pitches) %}


<div class="pitches">
    {% for pitch in pitches %}
    <div class="pitch">
        <h4 class="pitch__username">{{pitch.user.username}} </h4>
        <p class="pitch__text"> {{pitch.text}} </p>

        <form action="/upvote/{{pitch.id}}" method="POST">
            <button type="submit">Upvote</button>
        </form>

        <form action="/downvote/{{pitch.id}}" method="POST">
            <button type="submit">Downvote</button>
        </form>
        <p>upvotes {{pitch.upvotes|length}} </p>
        <p>downvotes {{pitch.downvotes| length}} </p>


        <button class="collapsible">{{pitch.comments | length}} Comments</button>

        <div class="content">
            <form action="/create-comment/{{pitch.id}}" method="POST">
                <input required type="text" name="text">
                <input type="submit" value="Add Comment">
            </form>
            {% for comment in pitch.comments %}
            <p>{{comment.user.username}}: {{comment.text}} </p>

            {% endfor %}
        </div>


    </div>
    {% endfor %}

    <script>
        var coll = document.getElementsByClassName("collapsible");
        var i;

        for (i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function () {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.maxHeight) {
                    content.style.maxHeight = null;
                } else {
                    content.style.maxHeight = content.scrollHeight + "px";
                }
            });
        }
    </script>

</div>


{% endmacro %}